# æ–°é—»æ’­æŠ¥è§†é¢‘ç”ŸæˆåŠŸèƒ½è¯´æ˜

## ğŸ“¹ åŠŸèƒ½æ¦‚è¿°

å°†æ–°é—»æ’­æŠ¥éŸ³é¢‘ï¼ˆMP3ï¼‰+ é™æ€å›¾ç‰‡åˆæˆä¸ºè§†é¢‘ï¼ˆMP4ï¼‰ï¼Œæ”¯æŒå¤šç§éŸ³é¢‘å¯è§†åŒ–æ•ˆæœã€‚

---

## ğŸ¬ è§†è§‰æ•ˆæœç±»å‹

### 1. **Waveï¼ˆæ³¢å½¢å›¾ï¼‰** - æ¨èæ’­å®¢/æ–°é—»
```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  ä¼ ç»ŸéŸ³é¢‘æ³¢å½¢ï¼Œä¼˜é›…ç®€æ´
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

### 2. **Spectrumï¼ˆé¢‘è°±å›¾ï¼‰** - æ¨èéŸ³ä¹
```
â•‘â•‘â•‘â•‘â•‘â•‘â•‘â•‘â•‘â•‘â•‘â•‘â•‘â•‘â•‘â•‘â•‘â•‘â•‘â•‘
  é¢‘ç‡æŸ±çŠ¶å›¾ï¼ŒåŠ¨æ„Ÿç‚«é…·
â•‘â•‘â•‘â•‘â•‘â•‘â•‘â•‘â•‘â•‘â•‘â•‘â•‘â•‘â•‘â•‘â•‘â•‘â•‘â•‘
```

### 3. **Vectorscopeï¼ˆçŸ¢é‡ç¤ºæ³¢å™¨ï¼‰** - é«˜ç«¯æ•ˆæœ
```
    â•±â•²
   â•±  â•²
  â•±    â•²
  ç«‹ä½“å£°ç›¸ä½å›¾ï¼Œåœ†å½¢æ³¢æµª
```

### 4. **Noneï¼ˆæ— æ•ˆæœï¼‰** - çº¯é™æ€å›¾ç‰‡
```
åªæœ‰èƒŒæ™¯å›¾ç‰‡ + éŸ³é¢‘
```

---

## ğŸš€ å¿«é€Ÿä½¿ç”¨

### æ–¹æ³• 1: å®Œæ•´å·¥ä½œæµï¼ˆæ¨èï¼‰
```powershell
# å®Œæ•´æµç¨‹ï¼šæŠ“æ–°é—» â†’ ç”Ÿæˆæ’­æŠ¥ â†’ ç”ŸæˆéŸ³é¢‘ â†’ æ·»åŠ BGM â†’ ç”Ÿæˆè§†é¢‘
.\run_workflow.ps1

# è·³è¿‡æŸäº›æ­¥éª¤ï¼ˆå¦‚åªç”Ÿæˆè§†é¢‘ï¼‰
.\run_workflow.ps1 -SkipFetch -SkipBroadcast -SkipAudio -SkipBGM
```

### æ–¹æ³• 2: å•ç‹¬ç”Ÿæˆè§†é¢‘
```powershell
# å¿«é€Ÿæµ‹è¯•ï¼šå¤„ç†æœ€æ–°æ’­æŠ¥ï¼Œç”Ÿæˆå¤šç§æ•ˆæœ
.\ç”Ÿæˆè§†é¢‘.ps1

# æˆ–ç›´æ¥è¿è¡Œ
uv run python generate_video.py
```

### æ–¹æ³• 3: Python APIï¼ˆé«˜çº§ç”¨æˆ·ï¼‰
```python
from pathlib import Path
from generate_video import NewsVideoGenerator

# åˆå§‹åŒ–ç”Ÿæˆå™¨
generator = NewsVideoGenerator()

# ç”Ÿæˆè§†é¢‘
generator.generate_video(
    audio_path=Path("audio.mp3"),
    output_path=Path("output.mp4"),
    image_path=Path("background.jpg"),  # å¯é€‰
    effect="wave",                       # wave/spectrum/vectorscope/none
    wave_position="bottom",              # top/bottom/center
    color_scheme="tech",                 # default/gradient/blue/gold/tech
    wave_height=200,                     # æ³¢å½¢é«˜åº¦ï¼ˆåƒç´ ï¼‰
    video_quality=23                     # 18=é«˜è´¨é‡ï¼Œ28=ä½è´¨é‡
)
```

---

## ğŸ¨ é¢œè‰²æ–¹æ¡ˆ

| æ–¹æ¡ˆ | æ•ˆæœ | é€‚ç”¨åœºæ™¯ |
|------|------|---------|
| `default` | çº¯ç™½è‰² | ç®€æ´ä¸“ä¸š |
| `gradient` | çº¢ç»¿è“æ¸å˜ | å½©è™¹æ•ˆæœ |
| `blue` | å¤©è“è‰² | ç§‘æŠ€å†·è‰² |
| `gold` | é‡‘è‰² | é«˜ç«¯å•†åŠ¡ |
| `tech` | é’ç»¿æ¸å˜ | ç§‘æŠ€æœªæ¥æ„Ÿ â­ |

---

## ğŸ–¼ï¸ èƒŒæ™¯å›¾ç‰‡ç®¡ç†

### ä¸‹è½½èƒŒæ™¯å›¾ç‰‡
```powershell
uv run python download_background.py
```

æ”¯æŒçš„ä¸»é¢˜ï¼š
1. æ–°é—»æ¼”æ’­å®¤
2. ç°ä»£åŠå…¬å®¤
3. ç§‘æŠ€æŠ½è±¡
4. çº¯è‰²æ¸å˜ï¼ˆæœ¬åœ°ç”Ÿæˆï¼Œæ— éœ€ç½‘ç»œï¼‰

### ä½¿ç”¨è‡ªå®šä¹‰å›¾ç‰‡
1. å°†å›¾ç‰‡å‘½åä¸º `news_background.jpg`
2. æ”¾åœ¨ `news_viewer/` ç›®å½•
3. æ¨èå°ºå¯¸ï¼š1280x720ï¼ˆ16:9ï¼‰

### æ— èƒŒæ™¯å›¾ç‰‡æ—¶
ç³»ç»Ÿä¼šè‡ªåŠ¨ä½¿ç”¨æ·±è“è‰²çº¯è‰²èƒŒæ™¯ã€‚

---

## ğŸ“Š è¾“å‡ºç¤ºä¾‹

```
broadcasts/
â””â”€â”€ 20251014_081240/
    â”œâ”€â”€ broadcast.json
    â”œâ”€â”€ broadcast.txt
    â”œâ”€â”€ audio_full.mp3              # åŸå§‹éŸ³é¢‘
    â”œâ”€â”€ audio_full_with_bgm.mp3     # å¸¦BGMéŸ³é¢‘
    â”œâ”€â”€ video_full_with_bgm.mp4     # æ³¢å½¢è§†é¢‘ï¼ˆç§‘æŠ€é£ï¼‰
    â””â”€â”€ video_full_with_bgm_1.mp4   # é¢‘è°±è§†é¢‘ï¼ˆæ¸å˜ï¼‰
```

---

## ğŸ”§ æŠ€æœ¯å‚æ•°è¯´æ˜

### è§†é¢‘è´¨é‡ï¼ˆCRFï¼‰
- `18`: é«˜è´¨é‡ï¼Œæ–‡ä»¶å¤§ï¼ˆçº¦ 5-10 MB/åˆ†é’Ÿï¼‰
- `23`: å¹³è¡¡è´¨é‡ï¼ˆæ¨èï¼Œçº¦ 2-5 MB/åˆ†é’Ÿï¼‰â­
- `28`: ä½è´¨é‡ï¼Œæ–‡ä»¶å°ï¼ˆçº¦ 1-2 MB/åˆ†é’Ÿï¼‰

### æ³¢å½¢é«˜åº¦
- `100`: ç»†çº¿æ•ˆæœ
- `200`: æ ‡å‡†é«˜åº¦ â­
- `300`: ç²—å£®é†’ç›®

### æ³¢å½¢ä½ç½®
- `bottom`: åº•éƒ¨ï¼ˆæ¨èï¼‰â­
- `top`: é¡¶éƒ¨
- `center`: å±…ä¸­ï¼ˆä»… vectorscope æ¨èï¼‰

---

## ğŸ¯ å¸¸è§ç”¨ä¾‹

### æ’­å®¢/æ–°é—»æ’­æŠ¥ï¼ˆæ¨èé…ç½®ï¼‰
```python
generator.generate_video(
    audio_path=audio,
    output_path=output,
    effect="wave",
    color_scheme="tech",
    wave_position="bottom",
    video_quality=23
)
```

### éŸ³ä¹å¯è§†åŒ–
```python
generator.generate_video(
    audio_path=audio,
    output_path=output,
    effect="spectrum",
    color_scheme="gradient",
    wave_position="bottom",
    video_quality=20  # éŸ³ä¹éœ€è¦æ›´é«˜è´¨é‡
)
```

### æç®€é£æ ¼
```python
generator.generate_video(
    audio_path=audio,
    output_path=output,
    effect="none",  # æ— å¯è§†åŒ–
    video_quality=25  # é™æ€å›¾ç‰‡å¯ä»¥é™ä½è´¨é‡
)
```

---

## ğŸ“¦ ä¾èµ–è¦æ±‚

### å¿…éœ€
- **ffmpeg**: éŸ³è§†é¢‘å¤„ç†æ ¸å¿ƒå·¥å…·
  - Windows: ä¸‹è½½ https://ffmpeg.org/download.html
  - è§£å‹åå°† `bin/` ç›®å½•æ·»åŠ åˆ° PATH

### å¯é€‰
- **Pillow**: ç”¨äºæœ¬åœ°ç”Ÿæˆæ¸å˜èƒŒæ™¯
  ```bash
  uv pip install Pillow
  ```

### æ£€æŸ¥ä¾èµ–
```powershell
# æ£€æŸ¥ ffmpeg
ffmpeg -version

# æµ‹è¯•è§†é¢‘ç”Ÿæˆ
.\ç”Ÿæˆè§†é¢‘.ps1
```

---

## ğŸ› æ•…éšœæ’é™¤

### âŒ "ffmpeg ä¸å¯ç”¨"
**åŸå› **: ffmpeg æœªå®‰è£…æˆ–ä¸åœ¨ PATH ä¸­
**è§£å†³**: 
1. ä¸‹è½½ ffmpeg: https://ffmpeg.org/download.html
2. è§£å‹åˆ° `C:\ffmpeg`
3. æ·»åŠ  `C:\ffmpeg\bin` åˆ°ç³»ç»Ÿ PATH
4. é‡å¯ç»ˆç«¯éªŒè¯: `ffmpeg -version`

### âŒ "èƒŒæ™¯å›¾ç‰‡ä¸å­˜åœ¨"
**åŸå› **: æœªå‡†å¤‡èƒŒæ™¯å›¾ç‰‡
**è§£å†³**:
```powershell
# é€‰é¡¹1: ä¸‹è½½å›¾ç‰‡
uv run python download_background.py

# é€‰é¡¹2: ä½¿ç”¨çº¯è‰²èƒŒæ™¯ï¼ˆè‡ªåŠ¨é™çº§ï¼‰
# ç³»ç»Ÿä¼šè‡ªåŠ¨ä½¿ç”¨æ·±è“è‰²èƒŒæ™¯ï¼Œæ— éœ€æ‰‹åŠ¨æ“ä½œ
```

### âŒ è§†é¢‘æ–‡ä»¶è¿‡å¤§
**åŸå› **: CRF å€¼è®¾ç½®è¿‡ä½
**è§£å†³**: æé«˜ `video_quality` å‚æ•°ï¼ˆå¦‚ 23 â†’ 26ï¼‰

### âŒ è§†é¢‘è´¨é‡æ¨¡ç³Š
**åŸå› **: CRF å€¼è®¾ç½®è¿‡é«˜
**è§£å†³**: é™ä½ `video_quality` å‚æ•°ï¼ˆå¦‚ 23 â†’ 20ï¼‰

---

## ğŸ”® æœªæ¥æ‰©å±•æ–¹å‘

### å·²è§„åˆ’ï¼ˆæœªå®ç°ï¼‰
- [ ] **æ—¶é—´è½´å›¾ç‰‡åˆ‡æ¢**: æ ¹æ® JSON æè¿°åœ¨ä¸åŒæ—¶é—´ç‚¹åˆ‡æ¢èƒŒæ™¯å›¾ç‰‡
  ```json
  {
    "timeline": [
      {"start": "00:00", "end": "01:05", "image": "intro.jpg", "transition": "fade"},
      {"start": "01:05", "end": "02:30", "image": "main.jpg", "transition": "slide"}
    ]
  }
  ```
- [ ] **æ–‡å­—å­—å¹•å åŠ **: è‡ªåŠ¨ç”Ÿæˆå­—å¹•è½¨é“
- [ ] **Logo æ°´å°**: åœ¨è§†é¢‘è§’è½æ·»åŠ å°æ ‡
- [ ] **å¤šè¯­è¨€æ ‡é¢˜**: æ”¯æŒä¸­è‹±åŒè¯­æ ‡é¢˜

### æŠ€æœ¯å‚¨å¤‡
è¿™äº›åŠŸèƒ½éƒ½å¯ä»¥ç”¨ ffmpeg å®ç°ï¼Œé¢„ç•™æ¥å£ï¼š
```python
# æ—¶é—´è½´åˆ‡æ¢ï¼ˆå¤æ‚æ»¤é•œé“¾ï¼‰
def generate_video_with_timeline(self, timeline: dict):
    pass

# å­—å¹•å åŠ 
def add_subtitles(self, srt_file: Path):
    pass
```

---

## ğŸ“š å‚è€ƒèµ„æº

- **ffmpeg å®˜æ–¹æ–‡æ¡£**: https://ffmpeg.org/documentation.html
- **éŸ³é¢‘å¯è§†åŒ–æ»¤é•œ**: https://ffmpeg.org/ffmpeg-filters.html#Audio-Filters
  - `showwaves`: æ³¢å½¢å›¾
  - `showfreqs`: é¢‘è°±å›¾
  - `avectorscope`: çŸ¢é‡ç¤ºæ³¢å™¨
  - `showcqt`: æ’å®šQå˜æ¢é¢‘è°±
- **Unsplash API**: https://source.unsplash.com/

---

## ğŸ’¬ ä½¿ç”¨å»ºè®®

1. **é¦–æ¬¡ä½¿ç”¨**: è¿è¡Œ `.\ç”Ÿæˆè§†é¢‘.ps1` æµ‹è¯•æ‰€æœ‰æ•ˆæœ
2. **é€‰æ‹©é£æ ¼**: æ ¹æ®å†…å®¹ç±»å‹é€‰æ‹©å¯è§†åŒ–æ•ˆæœ
   - æ–°é—»æ’­æŠ¥ â†’ `wave` + `tech`
   - éŸ³ä¹èŠ‚ç›® â†’ `spectrum` + `gradient`
   - é‡‡è®¿æ’­å®¢ â†’ `wave` + `default`
3. **ä¼˜åŒ–æ€§èƒ½**: 
   - æµ‹è¯•æ—¶ç”¨ CRF=25ï¼ˆå¿«é€Ÿï¼‰
   - å‘å¸ƒæ—¶ç”¨ CRF=20ï¼ˆé«˜è´¨é‡ï¼‰
4. **æ‰¹é‡ç”Ÿæˆ**: ä¿®æ”¹ `generate_video.py` çš„ `configs` åˆ—è¡¨è‡ªå®šä¹‰è¾“å‡ºç‰ˆæœ¬

---

**Version**: 1.0.0  
**Last Updated**: 2025-10-14  
**Author**: IRC Agent Team
