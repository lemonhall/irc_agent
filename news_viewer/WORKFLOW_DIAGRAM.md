# æ–°é—»æ’­æŠ¥è§†é¢‘ç”Ÿæˆå·¥ä½œæµç¨‹å›¾

## å®Œæ•´æµç¨‹ï¼ˆæ—¶é—´è½´å¤šå›¾æ¨¡å¼ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     æ–°é—»æ’­æŠ¥è§†é¢‘ç”Ÿæˆæµç¨‹                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1ï¸âƒ£ æŠ“å–æ–°é—»
   fetch_news.py
   â†“
   news.json (æ–°é—»æ•°æ®)

2ï¸âƒ£ ç”Ÿæˆæ’­æŠ¥è„šæœ¬
   generate_broadcast.py
   â†“
   broadcasts/20251014_081240/broadcast.json (ç»“æ„åŒ–æ’­æŠ¥ç¨¿)
   broadcasts/20251014_081240/broadcast.txt (çº¯æ–‡æœ¬)

3ï¸âƒ£ æ–‡æœ¬è½¬è¯­éŸ³
   generate_audio.py
   â†“
   broadcast_00_intro.mp3 (å¼€åœºç™½)
   broadcast_01_world.mp3 (ä¸–ç•Œæ–°é—»)
   broadcast_02_asia.mp3 (äºšå¤ªæ–°é—»)
   ...
   broadcast_full.mp3 (å®Œæ•´éŸ³é¢‘)
   + å›å†™æ—¶é—´è½´åˆ° broadcast.json (start_time, end_time)

4ï¸âƒ£ AIé…ç½®å›¾ç‰‡ â­
   assign_images.py
   â†“
   â†’ DeepSeek åˆ†æå†…å®¹ â†’ ç”Ÿæˆæœç´¢å…³é”®è¯
   â†’ Unsplash æœç´¢ â†’ ä¸‹è½½å›¾ç‰‡
   â†“
   image_01_world.jpg
   image_02_asia.jpg
   image_03_americas.jpg
   ...
   + æ›´æ–° broadcast.json (image_file å­—æ®µ)

5ï¸âƒ£ æ·»åŠ éŸ³é¢‘BGM
   add_bgm.py --volume 0.15
   â†“
   broadcast_full_with_bgm.mp3 (äººå£°+BGMæ··éŸ³)

6ï¸âƒ£ ç”Ÿæˆæ—¶é—´è½´è§†é¢‘ â­
   generate_video_optimized.py
   
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ ç¬¬ä¸€é˜¶æ®µï¼šåˆ†æ®µç”Ÿæˆ                       â”‚
   â”‚                                         â”‚
   â”‚  broadcast_00_intro.mp3 + intro_bg.jpg  â”‚
   â”‚  â†’ ffmpeg (å›¾ç‰‡+éŸ³é¢‘) â†’ temp_video_00.mp4â”‚
   â”‚                                         â”‚
   â”‚  broadcast_01_world.mp3 + image_01.jpg  â”‚
   â”‚  â†’ ffmpeg (å›¾ç‰‡+éŸ³é¢‘) â†’ temp_video_01.mp4â”‚
   â”‚                                         â”‚
   â”‚  broadcast_02_asia.mp3 + image_02.jpg   â”‚
   â”‚  â†’ ffmpeg (å›¾ç‰‡+éŸ³é¢‘) â†’ temp_video_02.mp4â”‚
   â”‚                                         â”‚
   â”‚  ... (æ‰€æœ‰ç‰‡æ®µ)                          â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â†“
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ ç¬¬äºŒé˜¶æ®µï¼šæ‹¼æ¥åˆå¹¶                       â”‚
   â”‚                                         â”‚
   â”‚  temp_video_00.mp4                      â”‚
   â”‚  temp_video_01.mp4                      â”‚
   â”‚  temp_video_02.mp4                      â”‚
   â”‚  ...                                    â”‚
   â”‚  â†’ ffmpeg concat â†’ video_full_merged.mp4â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â†“
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ ç¬¬ä¸‰é˜¶æ®µï¼šæ·»åŠ éŸ³é¢‘å¯è§†åŒ–ç‰¹æ•ˆ              â”‚
   â”‚                                         â”‚
   â”‚  video_full_merged.mp4                  â”‚
   â”‚  â†’ ffmpeg (æ³¢å½¢/é¢‘è°±)                    â”‚
   â”‚  â†’ video_full_with_effects.mp4          â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â†“
   æ¸…ç†ä¸´æ—¶æ–‡ä»¶ (temp_video_*.mp4)

7ï¸âƒ£ æ·»åŠ è§†é¢‘BGM â­
   add_bgm_to_video.py --volume 0.15
   
   video_full_with_effects.mp4 (äººå£°+ç‰¹æ•ˆ)
   + bgm/xxx.mp3
   â†’ ffmpeg (éŸ³é¢‘æ··éŸ³ï¼Œè§†é¢‘ç›´æ¥å¤åˆ¶)
   â†“
   video_full_with_effects_with_bgm.mp4 âœ… æœ€ç»ˆæˆå“

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         æœ€ç»ˆè¾“å‡º                                     â”‚
â”‚                                                                     â”‚
â”‚  ğŸ“¹ video_full_with_effects_with_bgm.mp4                            â”‚
â”‚     - å¤šå›¾èƒŒæ™¯ï¼ˆéšæ–°é—»åˆ‡æ¢ï¼‰                                         â”‚
â”‚     - äººå£°æ’­æŠ¥                                                       â”‚
â”‚     - éŸ³é¢‘å¯è§†åŒ–ç‰¹æ•ˆï¼ˆæ³¢å½¢ï¼‰                                         â”‚
â”‚     - èƒŒæ™¯éŸ³ä¹                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ€§èƒ½ä¼˜åŠ¿

### ä¼ ç»Ÿæ–¹æ¡ˆï¼ˆåºŸå¼ƒï¼‰
```
æ¯ä¸ªç‰‡æ®µ: (éŸ³é¢‘ + å›¾ç‰‡ + ç‰¹æ•ˆå¤„ç†) â†’ æ…¢ âŒ
æ‹¼æ¥: æ‰€æœ‰ç‰‡æ®µ â†’ video.mp4
æ·»åŠ BGM: é‡æ–°ç¼–ç æ•´ä¸ªè§†é¢‘ â†’ ææ…¢ âŒ
æ€»è€—æ—¶: ~10-15åˆ†é’Ÿ
```

### ä¼˜åŒ–æ–¹æ¡ˆï¼ˆå½“å‰ï¼‰âœ…
```
ç¬¬ä¸€é˜¶æ®µ: (éŸ³é¢‘ + å›¾ç‰‡) â†’ å¿« âš¡
         æ¯ä¸ªç‰‡æ®µåªåšç®€å•åˆæˆï¼Œæ— ç‰¹æ•ˆ
         
ç¬¬äºŒé˜¶æ®µ: æ‹¼æ¥æ‰€æœ‰ç‰‡æ®µ â†’ å¿« âš¡
         
ç¬¬ä¸‰é˜¶æ®µ: ä¸€æ¬¡æ€§æ·»åŠ ç‰¹æ•ˆ â†’ ä¸­ç­‰ â±ï¸
         åªå¤„ç†ä¸€ä¸ªå®Œæ•´è§†é¢‘
         
ç¬¬å››é˜¶æ®µ: æ·»åŠ BGM â†’ æå¿« âš¡âš¡
         è§†é¢‘ä¸é‡æ–°ç¼–ç ï¼Œåªæ··éŸ³
         
æ€»è€—æ—¶: ~3-5åˆ†é’Ÿ
```

## å…³é”®æŠ€æœ¯ç‚¹

### 1. åˆ†æ®µç”Ÿæˆï¼ˆå›¾ç‰‡+éŸ³é¢‘ï¼‰
```bash
ffmpeg -i audio_01.mp3 -loop 1 -i image_01.jpg \
       -shortest -c:v libx264 -c:a aac \
       temp_video_01.mp4
```
- âœ… æ— å¤æ‚æ»¤é•œ
- âœ… ç¼–ç é€Ÿåº¦å¿«
- âœ… æ–‡ä»¶å°

### 2. æ— æŸæ‹¼æ¥
```bash
ffmpeg -f concat -i filelist.txt \
       -c copy video_merged.mp4
```
- âœ… ä¸é‡æ–°ç¼–ç 
- âœ… é€Ÿåº¦æå¿«

### 3. ç»Ÿä¸€æ·»åŠ ç‰¹æ•ˆ
```bash
ffmpeg -i video_merged.mp4 \
       -filter_complex "[0:a]showwaves=...[wave];[0:v][wave]overlay" \
       video_with_effects.mp4
```
- âœ… ä¸€æ¬¡æ€§å¤„ç†
- âœ… ç‰¹æ•ˆç»Ÿä¸€

### 4. BGMæ··éŸ³ï¼ˆè§†é¢‘ä¸åŠ¨ï¼‰
```bash
ffmpeg -i video.mp4 -stream_loop -1 -i bgm.mp3 \
       -filter_complex "[0:a][1:a]amix..." \
       -c:v copy \  # è§†é¢‘ç›´æ¥å¤åˆ¶ï¼Œä¸ç¼–ç ï¼
       video_with_bgm.mp4
```
- âš¡ è§†é¢‘ä¸é‡æ–°ç¼–ç 
- âš¡ é€Ÿåº¦æå¿«ï¼ˆåªå¤„ç†éŸ³é¢‘ï¼‰

## ä¸€é”®è¿è¡Œ

```powershell
# å®Œæ•´æµç¨‹
.\run_workflow.ps1 -UseTimeline

# åªé‡æ–°ç”Ÿæˆè§†é¢‘éƒ¨åˆ†
.\run_workflow.ps1 -SkipFetch -SkipBroadcast -SkipAudio -UseTimeline
```

## æ–‡ä»¶å¤§å°å¯¹æ¯”

| æ–‡ä»¶ | å¤§å° | è¯´æ˜ |
|------|------|------|
| broadcast_full.mp3 | ~5 MB | çº¯äººå£°éŸ³é¢‘ |
| broadcast_full_with_bgm.mp3 | ~5 MB | äººå£°+BGM |
| image_*.jpg | ~200 KB/å¼  | èƒŒæ™¯å›¾ç‰‡ |
| video_full_merged.mp4 | ~80 MB | åˆå¹¶åè§†é¢‘ï¼ˆæ— ç‰¹æ•ˆï¼‰|
| video_full_with_effects.mp4 | ~120 MB | æ·»åŠ ç‰¹æ•ˆå |
| video_full_with_effects_with_bgm.mp4 | ~120 MB | æœ€ç»ˆç‰ˆæœ¬ |

## æœªæ¥ä¼˜åŒ–æ–¹å‘

- [ ] å¹¶è¡Œç”Ÿæˆè§†é¢‘ç‰‡æ®µï¼ˆå¤šè¿›ç¨‹ï¼‰
- [ ] GPU åŠ é€Ÿç¼–ç ï¼ˆ-hwaccelï¼‰
- [ ] æ›´å¿«çš„ç¼–ç å‚æ•°ï¼ˆ-preset ultrafastï¼‰
- [ ] å›¾ç‰‡ç¼“å­˜å’Œå¤ç”¨
- [ ] å¢é‡æ›´æ–°ï¼ˆåªé‡æ–°ç”Ÿæˆå˜åŒ–çš„ç‰‡æ®µï¼‰
